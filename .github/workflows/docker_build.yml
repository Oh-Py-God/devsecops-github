name: Docker Build

on:
  workflow_call:
    inputs:
      image_name:
        required: true
        type: string

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # 1. Checkout the code
      - name: Checkout Code
        uses: actions/checkout@v4

      # 2. Build the Docker Image
      - name: Build Docker Image
        run: docker build -t ${{ inputs.image_name }}:${{ github.sha }} .

      # 3. Save Docker Image to tarball
      - name: Save Docker Image to tarball
        run: docker save ${{ inputs.image_name }}:${{ github.sha }} -o image.tar

      # 4. Upload Docker Image Artifact
      - name: Upload Docker Image Artifact
        uses: actions/upload-artifact@v4
        with:
          name: docker-image
          path: image.tar
